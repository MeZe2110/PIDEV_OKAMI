{% extends 'base.html.twig' %}

{% block title %}Salle index{% endblock %}

{% block body %}
    <style>
        table {
            background-color: rgba(0, 34, 255, 0.03);
            border-collapse: collapse;
            margin-top: 200px;
            width: 70%;
            font-size: 20px;
            margin-right: 50px;
            margin-left: 350px;
        }
        h1{
            text-align: center;
            font-size: 50px;
            font-weight: bold;
            color: blue;
            margin-bottom: 50px;
            margin-top: 100px;
        }
    </style>
    <h1 class="text-center">Salle Index</h1>
    <div class="search-bar" style="margin-left: 640px">
        <form class="search-form d-flex align-items-center" method="GET" action="{{ path('app_salle_index') }}">
            <input type="text" name="search" id="search-input" placeholder="Entrez votre recherche">
            <button type="submit" class="btn-primary">Chercher</button>
        </form>
    </div>
    <div class="d-flex align-items-center justify-content-center" style="height: 500px">

        <table class="table table-striped">
            <thead>
            <tr>
                <th scope="col">Id</th>
                <th scope="col">Num√©ro</th>
                <th scope="col">Etage</th>
                <th scope="col">Type</th>
                <th><a href="{{ path('app_salle_new') }}" class="btn btn-primary">Ajouter Salle</a></th>
                <th scope="col"></th>

            </tr>
            </thead>
            <tbody>
            {% for salle in salles %}
                <tr>
                    <td>{{ salle.id }}</td>
                    <td>{{ salle.numsa }}</td>
                    <td>{{ salle.etagesa }}</td>
                    <td>{{ salle.typesa }}</td>
                    <td>
                        <a href="{{ path('app_salle_show', {'id': salle.id}) }}" class="btn btn-primary">Consulter</a>
                        <a href="{{ path('app_salle_edit', {'id': salle.id}) }}" class="btn btn-primary">Modifier</a>
                    </td>
                    <td>{{ include('salle/_delete_form.html.twig') }}</td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="5">no records found</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

    <!--  Statistiques -->
    {% set nbSalleSoin = 0 %}
    {% set nbSalleOperation = 0 %}

    {% for salle in salles %}

        {% if salle.typesa == 'soin' %}
            {% set nbSalleSoin = nbSalleSoin + 1 %}
        {% elseif salle.typesa == 'operation' %}
            {% set nbSalleOperation = nbSalleOperation + 1 %}
        {% endif %}
    {% endfor %}

    <h1>Salle Par Type (%)</h1>
    <div class="card">
        <div class="card-body">

            <!-- Pie Chart -->
            <div id="pieChart"></div>
            <script>
                document.addEventListener("DOMContentLoaded", () => {
                    new ApexCharts(document.querySelector("#pieChart"), {
                        series: [
                            {{ nbSalleSoin }},
                            {{ nbSalleOperation }}
                        ],
                        chart: {
                            height: 350,
                            type: 'pie',
                            toolbar: {
                                show: true
                            }
                        },
                        labels: ['Soin', 'Operation']
                    }).render();
                });
            </script>
            <!-- End Pie Chart -->
        </div>
    </div>
{% endblock %}
